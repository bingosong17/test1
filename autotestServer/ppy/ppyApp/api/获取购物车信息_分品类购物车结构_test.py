# NOTE: Generated By HttpRunner v3.1.3
"""
    概要：
        获取购物车信息分品类购物车结构
    输入参数：

    输出参数：
        "goodsCountToDelete": 商品数量(最小值1)
        "goodsIdToDelete": 商品ID
        "preGoodsToDelete": 是否组合商品(取自商品信息preGoods)
    前置接口：
        验证码登陆
"""


from httprunner import HttpRunner, Config, Step, RunRequest, RunTestCase


class TestCase获取购物车信息分品类购物车结构(HttpRunner):

    config = Config("获取购物车信息分品类购物车结构").verify(False).base_url("${testEnv($business)}").variables(
        **{
            "business": "",
            "token": "JQdojrZQd+nh7nPIFYcRJOWv3nY/tqDCeP6ZlT1/CHEDUqcAP7ZWZQwWSbW9wmtGJE0jDWXL6+15+2Cj9aGX4V5guOoAZkxjzoIiO8WmLSFkls2hGpRVdZ82nZcjK2BVSn2pumts6U7/Qgp0ly9Sxg==",
        }).export(*["goodsCountToDelete","goodsIdToDelete","preGoodsToDelete"])

    teststeps = [
        Step(
            RunRequest("/ppy-mall/user/cart/v2")
            .get("/user/cart/v2")
            .with_headers(
                **{
                    "serviceName": "MALL",
                    "channel": "app",
                    "deviceId": "2cdf701146c959d296b4b455f9623536",
                    "version": "4.4.0",
                    "sessionId": "$token",
                    "Connection": "close",
                    "Accept-Encoding": "gzip",
                    "User-Agent": "okhttp/3.12.0",
                    "Content-Type": "application/json",
                    "Accept-Language": "zh-CN,zh;q=0.8",
                }
            ).extract()
            .with_jmespath("body.body.basketList[0].groupList[0].goodsCount","goodsCountToDelete")
            .with_jmespath("body.body.basketList[0].groupList[0].goodsList[0].goodsId", "goodsIdToDelete")
            .with_jmespath("body.body.basketList[0].groupList[0].goodsList[0].preGoods", "preGoodsToDelete")
            .validate()
            .assert_equal("status_code", 200)
            .assert_equal("body.statusCode", 2000)
        ),
    ]


if __name__ == "__main__":
    TestCase获取购物车信息分品类购物车结构().test_start()
"""
{
	"statusCode": 2000,
	"msg": null,
	"traceMsg": "traceId: null",
	"timestamp": 1598945068,
	"signType": null,
	"sign": null,
	"body": {
		"basketList": [{
			"goodsTypeCount": 1,
			"goodsCount": 2,
			"orderAmount": 7450,
			"paymentAmount": 12450,
			"paymentAmountNew": 7450,
			"preferentialAmount": 0,
			"moneyOffAmount": 0,
			"promPrefAmount": 0,
			"preferentialAmountText": "(商品金额¥74.50)",
			"preferentialAmountTextNew": null,
			"availableRedPacketList": [],
			"notAvailableRedPacketList": [],
			"redPacketCommentText": "暂无可用红包",
			"redPacketDeductedAmount": 0,
			"showRedPacketButton": false,
			"groupList": [{
				"groupNo": "00",
				"promType": "00",
				"promId": null,
				"promText": "拼单",
				"useRedPacket": null,
				"goodsAmount": 7450,
				"prefAmount": 0,
				"sku": 1,
				"goodsCount": 2,
				"expireTime": null,
				"linkText": null,
				"actionType": null,
				"actionContent": null,
				"actionParam": null,
				"goodsList": [{
					"promotionsType": "00",
					"promotionsId": 141316,
					"promotionsExpireTime": null,
					"sellId": 141316,
					"goodsId": 39088,
					"supplierId": null,
					"goodsName": "巴比鲜汁肉包80g*24个/袋",
					"mainImageUrl": "https://images.alpha.pinpianyi.cn/images/common/images/face/GOODS_39088_33763287.jpg",
					"goodsPacketUnit": "袋",
					"sellPrice": 3725,
					"crossOutPrice": 3825,
					"minBuyCount": 1,
					"maxBuyCount": 30,
					"userLimitCount": 30,
					"salesMonthCount": 47,
					"stockCount": 1977,
					"promotionTypeText": null,
					"buyCountLimitText": "1袋起批,限购30袋",
					"specification": "80g*24个/袋",
					"salesMonthCountText": "月销47袋",
					"stockCountText": "库存1977袋",
					"sellOut": false,
					"promotionsLimitCount": 30,
					"promotionsUserLimitCount": 30,
					"promotionsUserLimitText": null,
					"promotionsPriceTypeText": "拼单价",
					"tagList": [],
					"activityList": [],
					"subGoodsList": [],
					"preGoods": false,
					"useRedPacket": true,
					"rebateAmount": 0,
					"rebateAmountText": null,
					"comboMeal": null,
					"memberGoods": false,
					"expId": null,
					"expGroup": null,
					"twofoldnessBuyCount": 1,
					"sellLabel": "供应商自配",
					"serviceLabelList": null,
					"purchaseNumber": null,
					"promMonitorStockText": null,
					"cartPromShowExpire": false,
					"specifiedPriceSkuLimitText": null,
					"cartGoodsCount": null,
					"groupNo": "00",
					"goodsCount": 2,
					"locked": null,
					"comboGoods": false,
					"eventId": "1598944951643-15001-goods:39088"
				}]
			}],
			"settlePopupText": "满499.00起送，还差424.50",
			"freightAmount": 5000,
			"goodsAmount": 7450,
			"freightAmountText": "还差424.50达成起订",
			"beyondPrice": 49900,
			"refreshKey": "1989126284",
			"refresh": false,
			"existRedPackage": false,
			"comboPrefAmount": 0,
			"memberPrefAmount": 0,
			"novicePrefAmount": 0,
			"specifiedPricePrefAmount": 0,
			"redPacketGoodsAmount": null,
			"redPacketGoodsText": null,
			"basketId": -1,
			"basketName": "快消品",
			"notSatisfyRedPacketText": null,
			"beyondSpecifiedSkuLimitText": null
		}],
		"goodsTypeCount": 1,
		"goodsCount": 2,
		"goodsAmount": 7450,
		"orderAmount": 7450,
		"preferentialAmount": 0,
		"paymentAmount": 7450,
		"moneyOffAmount": 0,
		"promPrefAmount": 0,
		"comboPrefAmount": 0,
		"memberPrefAmount": 0,
		"novicePrefAmount": 0,
		"specifiedPricePrefAmount": 0,
		"preferentialAmountText": null,
		"canSettlementAmount": null,
		"redPacketCommentText": null,
		"nextRedPacketSource": null,
		"redPacketGoodsText": null,
		"redPacketGoodsAmount": null,
		"showPacketText": null,
		"packetId": null,
		"refreshKey": "1083769844",
		"gatherBasketText": "该商品已为您添加至可享更高优惠的品类",
		"gatherPacketText": "该活动商品不参与红包优惠",
		"beyondSpecifiedSkuLimitText": null,
		"purchaseMessage": null
	}
}
"""