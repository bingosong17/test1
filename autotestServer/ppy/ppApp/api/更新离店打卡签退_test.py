# NOTE: Generated By HttpRunner v3.1.4
"""
    概要：
        更新离店打卡签退
    输入参数：
        "leaveDistance": 签退距离，四舍五入保留整数
        "signId": 拜访记录id
        "leavePicUrls": 签退照片地址,可以支持多张
        "leaveLatitude": 离店维度
        "leaveLongitude": 离店经度
        "leavePosition": 离店位置
    输出参数：
        无
    前置接口：
        无
"""


from httprunner import HttpRunner, Config, Step, RunRequest, RunTestCase


class TestCase更新离店打卡签退(HttpRunner):

    config = Config("更新离店打卡签退").verify(False).base_url("${testEnv($business)}").variables(
        **{
            "business": "ppApp",
            "phone": "15757113586",
            "session": "${getSession($business,$phone)}",
            "leaveDistance": 0,
            "signId": 3633474,
            "leavePicUrls": [
                "https://images.alpha.pinpianyi.cn/images/face/yypp/ecb2e1f3e51745e8b43affd40cab7afc.jpg"
            ],
            "leaveLatitude": "30.20372151288134",
            "leaveLongitude": "120.2600125244454",
            "leavePosition": "浙江省杭州市萧山区金一路79号靠近湾区数字公园",
        })

    teststeps = [
        Step(
            RunRequest("/ppy-pinpin/visitRecord/updateSignOut")
            .post(
                "/visitRecord/updateSignOut"
            )
            .with_headers(
                **{
                    "appname": "",
                    "channel": "app",
                    "servicename": "NEW-PP",
                    "deviceid": "b4f7cdbd-65bf-362e-bec4-3cbbedd6e37b",
                    "appchannel": "official",
                    "sessionid": "$session",
                    "Content-Type": "application/json",
                    "Content-Length": "300",
                    "Connection": "Keep-Alive",
                    "Accept-Encoding": "gzip",
                    "User-Agent": "okhttp/3.12.1",
                }
            )
            .with_json(
                {
                    "leaveDistance": "$leaveDistance",
                    "signId": "$signId",
                    "leavePicUrls": "$leavePicUrls",
                    "leaveLatitude": "$leaveLatitude",
                    "leaveLongitude": "$leaveLongitude",
                    "leavePosition": "$leavePosition",
                }
            )
            .validate()
            .assert_equal("status_code", 200)
            .assert_equal("body.statusCode", 2000)
        ),
    ]


if __name__ == "__main__":
    TestCase更新离店打卡签退().test_start()
