# NOTE: Generated By HttpRunner v3.1.3
"""
    概要：
        新增爆品
    输入参数：
        "redPacketAvailable": 是否使用红包(0-不使用、1-使用
        "promotionsType": 促销类型  0：一般爆品，1：特价爆品
        "goodsId": 商品ID
        "traId": 商圈id
        "promotionsPrice": 促销价
        "maxNum": 限购量
        "initStock":限购库存
        "startTime": 活动开始时间
        "endTime": 活动结束时间
        "operateType": 操作类型不能为空，save-新增、update-更新
    输出参数：
        无
    前置接口：
        123344
"""


from httprunner import HttpRunner, Config, Step, RunRequest, RunTestCase


class TestCase新增爆品(HttpRunner):

    config = Config("新增爆品").verify(False).base_url("${testEnv($business)}").variables(
        **{
            "business": "yyht",
            "session": "${getSession($business)}",
            "redPacketAvailable": 0,
            "promotionsType": 0,
            "goodsId": 58,
            "traId": 11,
            "promotionsPrice": 35,
            "maxNum": 4,
            "initStock": 5,
            "startTime": "${hapentime(5,2,s)}",
            "endTime": "${hapentime(100,2)}",
            "operateType": "save",
        })

    teststeps = [
        Step(
            RunRequest("/dev1_t/mall/promo/saveAndSync")
            .post("/mall/promo/saveAndSync")
            .with_headers(
                **{
                    "Connection": "keep-alive",
                    "Content-Length": "1103",
                    "sessionId": "$session",
                    "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36",
                    "systemCode": "yypp",
                    "Content-Type": "application/json",
                    "Accept": "*/*",
                    "Sec-Fetch-Site": "same-origin",
                    "Sec-Fetch-Mode": "cors",
                    "Sec-Fetch-Dest": "empty",
                    "Accept-Encoding": "gzip, deflate, br",
                    "Accept-Language": "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",
                }
            )
            .with_json(
                {
                    "redPacketAvailable": "$redPacketAvailable",
                    "promotionsType": "$promotionsType",
                    "goodsId": "$goodsId",
                    "promoGoodsParams": [
                        {
                            "traId": "$traId",
                            "promotionsPrice": "$promotionsPrice",
                            "maxNum": "$maxNum",
                            "initStock": "$initStock",
                            "startTime": "$startTime",
                            "endTime": "$endTime",
                        },
                    ],
                    "operateType": "$operateType",
                }
            )
            .validate()
            .assert_equal("status_code", 200)
            .assert_equal("body.statusCode", 2000)
            .assert_equal("body.body", True)
        ),
    ]


if __name__ == "__main__":
    TestCase新增爆品().test_start()
"""
response:
{
	"redPacketAvailable": 0,
	"promotionsType": 0,
	"goodsId": 58,
	"promoGoodsParams": [{
		"traId": 11,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 14,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 15,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 104,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 171,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 173,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 174,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}, {
		"traId": 178,
		"promotionsPrice": 35,
		"maxNum": 4,
		"initStock": 5,
		"startTime": "2020-09-07 00:00:00",
		"endTime": "2020-09-09 00:00:00"
	}],
	"operateType": "save"
}
"""
