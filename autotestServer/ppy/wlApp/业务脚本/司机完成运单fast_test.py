# NOTE: Generated By HttpRunner v3.1.3
"""
    概要：
        司机完成运单的取货送货
    输入参数：
        "transOrderId": 运单id,
        "phoneNumber": 司机电话,
        "orderNo": 订单编号
    输出参数：
        无
    前置接口：
        验证码登陆
"""

from httprunner import HttpRunner, Config, Step, RunRequest, RunTestCase
from wlApp.api.获取运单详情_test import TestCase运单详情 as 运单详情
from wlApp.api.确认取货请求接口_test import TestCase确认取货请求 as 确认取货请求
from wlApp.api.出发取货_test import TestCase出发取货 as 出发取货
from wlApp.api.根据数据键获取数据字典值_test import TestCase根据数据键获取数据字典值 as 根据数据键获取数据字典值
from wlApp.api.取货单详情明细_test import TestCase取货单详情明细 as 取货单详情明细
from wlApp.api.获取退货运单列表接口_test import TestCase获取退货运单列表接口 as 获取退货运单列表接口
from wlApp.api.司机确认取货数量_test import TestCase司机确认取货数量 as 司机确认取货数量
from wlApp.api.司机查询司机已经确认的取货数量_test import TestCase司机查询司机已经确认的取货数量 as 司机查询司机已经确认的取货数量
from wlApp.api.获取供应商确认二维码信息_test import TestCase获取供应商确认二维码信息 as 获取供应商确认二维码信息
from wlApp.api.批量上传文件_test import TestCase上传照片 as 上传照片
from wlApp.api.司机根据上传照片确定取货完成_test import TestCase司机根据上传照片确定取货完成 as 司机根据上传照片确定取货完成
from wlApp.api.获取配送单详情_test import TestCase获取配送单详情 as 获取配送单详情
from wlApp.api.获取配送单商品详情_test import TestCase获取配送单商品详情 as 获取配送单商品详情
from wlApp.api.新增送达商品照片_test import TestCase送达商品照片 as 送达商品照片
from wlApp.api.生成用户确认二维码_test import TestCase生成用户确认二维码 as 生成用户确认二维码
from wlApp.api.用户拍照签收_test import TestCase用户拍照签收 as 用户拍照签收
from wlApp.api.确认配送单完成_test import TestCase确认配送单完成 as 确认配送单完成


class TestCase取送货(HttpRunner):

    config = Config("testcase description").verify(False).base_url("${testEnv($business)}").variables(
        **{
            "business": "wlApp",
            "transOrderId": 1191970371141841289,
            "phoneNumber": "13738113393",
            "token": "${getSession($business,$phoneNumber)}",
            "userId": "${getWlAppUserId($phoneNumber)}",
            "orderNo": "2020101113522214619546",
        }
    )
    teststeps = [
        Step(
            RunTestCase("查看运单详情").call(运单详情)
                .export(*["cloudStorageId", "pickupOrderIdList", "deliveryOrderId", "supplierId"])
        ),
        Step(
            RunTestCase("确认取货请求").call(确认取货请求).teardown_hook("${sleep_N_secs(1)}")
        ),
        Step(
            RunTestCase("出发取货").call(出发取货)
        ),
        Step(
            RunTestCase("点击确定取货到达取货点").call(根据数据键获取数据字典值)
        ),
        Step(
            RunTestCase("查看取货单详情明细").call(取货单详情明细)
                .export(*["amount", "goodsId","orderIdList","classType"])
        ),
        Step(
            RunTestCase("标记取货商品已经核对").call(获取退货运单列表接口)
        ),
        Step(
            RunTestCase("司机确认取货数量").call(司机确认取货数量)
                .export(*["confirmVersion"]).teardown_hook("${sleep_N_secs(2)}")
        ),
        Step(
            RunTestCase("司机查询司机已经确认的取货数量").with_variables(
                **{
                    "pickupOrderId": "$pickupOrderIdList"
                }
            ).call(司机查询司机已经确认的取货数量)
                .teardown_hook("${sleep_N_secs(2)}")
        ),
        Step(
            RunTestCase("获取供应商确认二维码信息").call(获取供应商确认二维码信息)
        ),
        Step(
            RunTestCase("司机上传照片确认取货").call(上传照片)
                .export(*["photoList"]).teardown_hook("${sleep_N_secs(2)}")
        ),
        Step(
            RunTestCase("司机根据上传照片确定取货完成").call(司机根据上传照片确定取货完成)
                .teardown_hook("${sleep_N_secs(2)}")
        ),
        Step(
            RunTestCase("获取配送单详情").call(获取配送单详情).export(*["orderRelId"])
        ),
        Step(
            RunTestCase("司机上传照片确认送货").with_variables(
                **{
                    "pickupOrderIdList": "$deliveryOrderId",
                }
            ).call(上传照片)
                .export(*["photoList"]).teardown_hook("${sleep_N_secs(2)}")
        ),
        Step(
            RunTestCase("送达商品照片").call(送达商品照片).teardown_hook("${sleep_N_secs(1)}")
        ),
        Step(
            RunTestCase("生成用户确认二维码").call(生成用户确认二维码).teardown_hook("${sleep_N_secs(1)}")
        ),
        Step(
            RunTestCase("用户拍照签收").call(用户拍照签收).teardown_hook("${sleep_N_secs(2)}")
        ),
        Step(
            RunTestCase("确认配送单完成").call(确认配送单完成)
        ),

    ]


if __name__ == "__main__":
    TestCase取送货().test_start()
